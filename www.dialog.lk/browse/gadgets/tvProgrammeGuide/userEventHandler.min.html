function generateRequestUrlForMainContent(a){var b=$("#activeTvPackageId").val(),c=new Array;$.each($("input[name='channelCategory']:checked"),function(){c.push($(this).val())});var d=new Array;$.each($("input[name='channelLanguage']:checked"),function(){d.push($(this).val())});var e=new Array;$.each($("input[name='hd']:checked"),function(){e.push($(this).val())});var f=$("#categoryId").val(),g="/dlg/browse/gadgets/tvProgrammeGuide/mainContent.jsp";return b?g=g+"?packageId="+b:g+="?packageId=all",c.length>0&&(g=g+"&categories="+c),d.length>0&&(g=g+"&languages="+d),1==e.length&&(g=g+"&isHd="+e),g=g+"&date="+a+"&categoryId="+f}function showWaitPopup(){$.ajax({url:"/dlg/browse/gadgets/common/waitPopUp.jsp",data:{},success:function(a){$("#popUpMessage").html(a),$("#popUpMessage").bPopup({fadeSpeed:"slow",followSpeed:1500,modalColor:"black"})}})}function closeWaitPopup(){$("#popUpMessage").bPopup().close()}function refreshDaysBarAndMainContent(){var a=getToday(),b="/dlg/browse/gadgets/tvProgrammeGuide/showDaysBar.jsp?today="+a;xmlhttpPost(b,function(b){$("#daysBar").empty().append(b),mainConturl=generateRequestUrlForMainContent(a),refreshMainContent(mainConturl)})}function refreshMainContent(a){xmlhttpPost(a,function(a){$("#tv-programme").empty().append(a),$("#epgUpdateBtn").removeAttr("disabled"),$("#loadingDiv").hide(),setDIVHeight()})}function getToday(){var a=$("#requestedDate").val();if(a)return a;var b=new Date,c=b.getDate(),d=b.getMonth()+1,e=b.getFullYear();return b=e+"-"+d+"-"+c}function shrinkDropDowns(){$(".dropdown.open").attr("class","dropdown")}$(".tv-packages a").click(function(a){a.preventDefault(),$(".active-tv-package").text($(this).text()),$(".tv-package").val($(this).data("package")),a.stopPropagation();var b=$(this),c=b.children("input[name='packageId']").val();$("#activeTvPackageId").val(c)}),$("#daysBar").on("click","li#date",function(a){a.preventDefault(),a.stopPropagation(),$('[id^="channelProgrammes"]').html(""),$('[id^="channelProgrammes"]').remove(),$("#tv-programme").html(""),$("#loadingDiv").show(),$("#daysBar li.active").removeAttr("class");var b=$(this);b.attr("class","active");var c=b.children("input").val();mainConturl=generateRequestUrlForMainContent(c),refreshMainContent(mainConturl)}),$("#epgUpdateBtn").click(function(a){a.preventDefault(),$("#epgUpdateBtn").attr("disabled","disabled"),$("#channelProgrammes").html(""),$("#tv-programme").html(""),$("#loadingDiv").show(),a.stopPropagation(),shrinkDropDowns(),refreshDaysBarAndMainContent()}),$("#tv-programme").on("click",".programme-popup",function(a){a.preventDefault(),a.stopPropagation();var b=$(this),c=b.children("input[name='programmeName']").val(),d=b.children("input[name='channelSkuId']").val(),e=b.children("input[name='startTime']").val(),f=b.children("input[name='description']").val(),g=b.children("input[name='duration']").val(),h=b.children("input[name='programImageUrl']").val(),i=b.attr("href");if(i){var j="/dlg/browse/gadgets/tvProgrammeGuide/showProgrammeDetails.jsp",k=j+"?programmeName="+c+"&channelSkuId="+d+"&startTime="+e+"&description="+f+"&duration="+g+"&programImageUrl="+h;xmlhttpPost(k,function(a){$("#modal-dialog-details").empty().append(a),$("#programme-modal-details").modal("show")})}});