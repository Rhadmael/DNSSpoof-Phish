(function(a){a.fn.jqZoomIt=function(n){if(this.length>1){this.each(function(){a(this).jqZoomIt(n)});return this}var d={mouseEvent:"mouseenter",zoomAreaMove:"mousemove",zoomPosition:"right",zoomClass:"zoomIt_zoomed",zoomLoadingClass:"zoomIt_loading",zoomAreaClass:"zoomIt_area",zoomAreaColor:"#00ccff",zoomAreaOpacity:0.3,zoomDistance:10,multiplierX:1.3,multiplierY:1.2,init:function(){},zoom:function(){},close:function(){},is_touch:null};var n=a.extend({},d,n),l=this,i=a(this).attr("href"),b=a("img",this);if(""==i||0==b.length){return false}var g=function(){m();h();var o=c()?"touchstart":("click"==n.mouseEvent?"click":"mouseenter"),p=c()?"touchend":"mouseleave";a(l).bind(o,function(q){q.preventDefault();j();n.zoom.call(l,{})});a(l).bind(p,function(){f();n.close.call(l,{})});a(window).resize(m);n.init.call(l,{});return l};var j=function(){var p=k(),q=e();a(p.zoomer).show().css({top:q.zTop,left:q.zLeft});if(a.data(l,"no_zoom")){return}a(p.preview).show();if(a.data(l,"loaded")){return}a(p.zoomer).addClass(n.zoomLoadingClass);var o=a("<img />",{src:i}).load(function(){a(p.zoomer).removeClass(n.zoomLoadingClass);o.css({position:"absolute",top:0,left:0}).appendTo(a(p.zoomer));a.data(l,"loaded",true);var w=o.width(),s=o.height(),r=w/q.width,x=s/q.height,t=q.width/r*(n.multiplierX||1),u=q.height/x*(n.multiplierY||1);if(n.multiplierX>r&&n.multiplierY>x){a(p.zoomer).css({width:w,height:s});a.data(l,"no_zoom",true);return}if("drag"==n.zoomAreaMove&&a.fn.draggable&&!c()){a(l).removeAttr("href");a(p.preview).draggable({containment:"parent",drag:function(y,z){var C=a(p.preview).position(),B=-(C.left*r),A=-(C.top*x);o.css({left:B,top:A})}})}else{var v=c()?"touchmove":"mousemove";a(l).bind(v,function(D){var z=0,y=0;if(c()){D.preventDefault();event=D.originalEvent.touches[0]||D.originalEvent.changedTouches[0];z=event.pageX;y=event.pageY}else{z=D.pageX;y=D.pageY}var A=e(),C=z-A.left-t/2,B=y-A.top-u/2;if(z<A.left+t/2){C=0}if(y<A.top+u/2){B=0}if(z>(A.left+A.width-t/2)){C=A.width-t}if(y>(A.top+A.height-u/2)){B=A.height-u}a(p.preview).css({left:C,top:B});o.css({left:-(C*r),top:-(B*x)})})}a(p.preview).css({width:t,height:u})})};var f=function(){var o=k();a(o.zoomer).css({top:-5000,left:-5000});a(o.preview).hide()};var m=function(){var o=a(b[0]).offset(),p={width:a(b[0]).outerWidth(),height:a(b[0]).outerHeight(),top:o.top,left:o.left,zTop:o.top,zLeft:o.left};switch(n.zoomPosition){case"right":default:p.zLeft+=p.width+n.zoomDistance;break;case"left":p.zLeft-=p.width*(n.multiplierX||1)+n.zoomDistance;break;case"bottom":p.zTop+=p.height+n.zoomDistance;break;case"top":p.zTop-=p.height*(n.multiplierY||1)+n.zoomDistance;break}a.data(b[0],"size",p);return p};var e=function(){return a.data(b[0],"size")};var h=function(){var r=a("<div />",{"class":n.zoomAreaClass,css:{"background-color":n.zoomAreaColor||"#999",opacity:n.zoomAreaOpacity||0.7,display:"none",position:"absolute",top:0,left:0,cursor:"move","z-index":1000}}).appendTo(a(l));var o=e();var q=a("<div />",{"class":n.zoomClass,css:{display:"none",position:"absolute",top:-1000,overflow:"hidden",width:o.width*(n.multiplierX||1),height:o.height*(n.multiplierY||1),"z-index":1050}}).appendTo(a(document.body));var p={zoomer:q,preview:r};a.data(b[0],"elems",p)};var k=function(){return a.data(b[0],"elems")};var c=function(){if(n.is_touch!==null){return n.is_touch}return/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)};return g()}})(jQuery);